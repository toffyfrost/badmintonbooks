"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),n=require("@liff/consts"),i=require("@liff/util"),r=require("@liff/is-in-client"),t=require("@liff/get-os"),o=require("@liff/get-line-version"),f=require("@liff/native-bridge"),l=require("@liff/use"),u=function(e,n){return e?"&".concat(e.split("&").filter((function(e){return-1===e.indexOf("is_liff_external_open_window")})).join("&").concat("".concat(n?"#".concat(n):""))):"".concat(n?"#".concat(n):"")};function a(l){if(!function(n){if(!n||"object"!=typeof n)return!1;var i=n,r=i.url,t=i.external,o=e.__read([typeof r,typeof t],2),f=o[0],l=o[1];return"string"===f&&""!==r&&("undefined"===l||"boolean"===l)}(l))throw i.createLiffError(n.INVALID_ARGUMENT,"Invalid parameters for liff.openWindow()");var a=o.getLineVersion();if(r.isInClient())if(null!==a&&"ios"===t.getOS()&&i.compareVersion(a,"9.19")>=0||!window._liff.postMessage){var c=l.url,d=l.external,s=void 0!==d&&d;window.open(function(n,i){var r,t,o,f,l,a,c,d,s,p;(function(e){return-1!==e.indexOf("#")&&-1!==e.indexOf("?")&&e.indexOf("#")<e.indexOf("?")})(n)||function(e){return-1===e.indexOf("?")&&-1!==e.indexOf("#")}(n)?(c=(r=e.__read(n.split("#"),2))[0],d=void 0===(t=r[1])?"":t,s=(o=e.__read(d.split("?"),2))[0],p=o[1]):(c=(f=e.__read(n.split("?"),2))[0],d=void 0===(l=f[1])?"":l,p=(a=e.__read(d.split("#"),2))[0],s=a[1]);var _=u(p,s);return"".concat(c,"?").concat("is_liff_external_open_window","=").concat(!!i).concat(_)}(c,s))}else f.call("openWindow",l);else window.open(l.url,"_blank")}var c=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return e.__extends(i,n),Object.defineProperty(i.prototype,"name",{get:function(){return"openWindow"},enumerable:!1,configurable:!0}),i.prototype.install=function(){return function(e){return a(e)}},i}(l.LiffModule);exports.OpenWindowModule=c,exports.openWindow=a;
