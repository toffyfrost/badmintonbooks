"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("tslib"),n=require("@liff/use"),r=require("@liff/consts"),i=require("@liff/util"),o=require("@liff/server-api"),s="undefined"==typeof navigator?"en":null!==(e=navigator.language)&&void 0!==e?e:"en",a=null;function u(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return s=e,[4,c()];case 1:return t.sent(),[2]}}))}))}function c(){return t.__awaiter(this,void 0,void 0,(function(){var e,n;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,o.fetch("".concat("https://liffsdk.line-scdn.net/xlt/manifest.json"),{method:"GET",headers:{Accept:"application/json"}})];case 1:return e=t.sent(),n="".concat(s),!e.languages[n]&&s.includes("-")&&(n=s.split("-")[0]),e.languages[n]||(n="en"),[4,o.fetch("".concat("https://liffsdk.line-scdn.net/xlt","/").concat(e.languages[n]),{method:"GET",headers:{Accept:"application/json"}})];case 2:return a=t.sent(),[2]}}))}))}var l=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"name",{get:function(){return"i18n"},enumerable:!1,configurable:!0}),n.prototype.install=function(e){return e.internalHooks.init.beforeFinished(this.beforeInitFinished.bind(this)),{setLang:u}},n.prototype.beforeInitFinished=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(e){switch(e.label){case 0:return[4,c()];case 1:return e.sent(),[2]}}))}))},n}(n.LiffModule),f=new l;exports.I18nModule=l,exports.module=f,exports.t=function(e){if(null===a)throw i.createLiffError(r.INIT_FAILED,"please call xlt after liff.init");return a[e]};
