"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("@liff/logger"),n=function(e,t){this._driver=e,this.liff=t,this.hooks=this._driver.hooks,this.internalHooks=this._driver.internalHooks},o=function(e,t){this._driver=e,this.liff=t,this.hooks=this._driver.hooks},i=function(){function e(e,t){this.pluginCtx=new o(e,t),this.moduleCtx=new n(e,t)}return Object.defineProperty(e.prototype,"pluginContext",{get:function(){return this.pluginCtx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moduleContext",{get:function(){return this.moduleCtx},enumerable:!1,configurable:!0}),e}(),r=function(){function t(){this.modules=new Map,this.hooks={},this.internalHooks={}}return t.prototype.addModule=function(t,n){this.modules.set(t,n),n.hooks&&(this.hooks[t]=Object.entries(n.hooks).reduce((function(t,n){var o,i=e.__read(n,2),r=i[0],s=i[1];return e.__assign(e.__assign({},t),((o={})[r]=s.on.bind(s),o))}),{})),"internalHooks"in n&&n.internalHooks&&(this.internalHooks[t]=Object.entries(n.internalHooks).reduce((function(t,n){var o,i=e.__read(n,2),r=i[0],s=i[1];return e.__assign(e.__assign({},t),((o={})[r]=s.on.bind(s),o))}),{}))},t.prototype.hasModule=function(e){return this.modules.has(e)},t}(),s=function(){},u=function(e){return e instanceof s},a=function(n){function o(e,t,o){var i=n.call(this)||this;return i.driver=e,i.contextHolder=t,i.option=o,i}return e.__extends(o,n),o.prototype.install=function(){return this.factory(this.driver,this.contextHolder)},Object.defineProperty(o.prototype,"name",{get:function(){return"use"},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"defaultOption",{get:function(){return{namespacePrefix:"$"}},enumerable:!1,configurable:!0}),o.prototype.factory=function(e,n){var o=Object.assign({},this.defaultOption,this.option).namespacePrefix;return function(i,r){if(!i||"function"!=typeof i.install||"string"!=typeof i.name)return t.logger.warn("To install the plugin, you need to define the `name` property and the `install` method."),this;var s=u(i)?i.name:"".concat(o).concat(i.name);if(e.hasModule(s))return this;var a=u(i)?i.install.call(i,n.moduleContext,r):i.install.call(i,n.pluginContext,r);return this["".concat(s)]?(t.logger.warn("There is a duplicate plugin name. `".concat(s,"` plugin namespace will be override.")),this["".concat(s)]=a):void 0!==a&&(this["".concat(s)]=a),e.addModule(s,i),this}},o}(s);exports.ContextHolder=i,exports.LiffModule=s,exports.ModuleDriverImpl=r,exports.UseModule=a,exports.isLiffModule=u;
