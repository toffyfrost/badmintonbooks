import{__awaiter as t,__generator as r,__extends as e,__spreadArray as n,__read as o}from"tslib";import{LiffModule as i}from"@liff/use";import{validators as c}from"@liff/is-api-available";import{call as u}from"@liff/native-bridge";import{createLiffError as a}from"@liff/util";import{UNKNOWN as f}from"@liff/consts";function d(e){var n=e.productIds;return t(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,u("iap.getPlatformProducts",{productIds:n}).catch((function(t){if(t.code&&t.description)throw a(t.code,t.description);throw a(f,"Failed to get platform products",{cause:t})}))];case 1:return[2,t.sent().products]}}))}))}var s=function(e){var n=e.productId,o=e.orderId;return t(void 0,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,u("iap.createPayment",{productId:n,orderId:o}).catch((function(t){if(t.code&&t.description)throw a(t.code,t.description);throw a(f,"Failed to get platform products",{cause:t})}))];case 1:return t.sent(),[2]}}))}))},p=function(i){function p(){return null!==i&&i.apply(this,arguments)||this}return e(p,i),Object.defineProperty(p.prototype,"name",{get:function(){return"iap"},enumerable:!1,configurable:!0}),p.prototype.install=function(){var e=this;return{getPlatformProducts:function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return t(e,void 0,void 0,(function(){return r(this,(function(t){return c.iap(),[2,d.apply(void 0,n([],o(i),!1))]}))}))},createPayment:function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return t(e,void 0,void 0,(function(){return r(this,(function(t){return c.iap(),[2,s.apply(void 0,n([],o(i),!1))]}))}))},requestConsentAgreement:function(){return t(e,void 0,void 0,(function(){return r(this,(function(e){return c.iap(),[2,t(void 0,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,u("iap.requestConsentAgreement").catch((function(t){if(t.code&&t.description)throw a(t.code,t.description);throw a(f,"Failed to request consent agreement",{cause:t})}))];case 1:return t.sent(),[2]}}))}))]}))}))}}},p}(i);export{p as IapModule};
