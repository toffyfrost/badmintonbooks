"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("tslib"),e=require("@liff/use"),t=require("@liff/is-api-available"),i=require("@liff/native-bridge"),n=require("@liff/util"),o=require("@liff/consts");function a(e){var t=e.productIds;return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,i.call("iap.getPlatformProducts",{productIds:t}).catch((function(r){if(r.code&&r.description)throw n.createLiffError(r.code,r.description);throw n.createLiffError(o.UNKNOWN,"Failed to get platform products",{cause:r})}))];case 1:return[2,r.sent().products]}}))}))}var c=function(e){var t=e.productId,a=e.orderId;return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,i.call("iap.createPayment",{productId:t,orderId:a}).catch((function(r){if(r.code&&r.description)throw n.createLiffError(r.code,r.description);throw n.createLiffError(o.UNKNOWN,"Failed to get platform products",{cause:r})}))];case 1:return r.sent(),[2]}}))}))},u=function(e){function u(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(u,e),Object.defineProperty(u.prototype,"name",{get:function(){return"iap"},enumerable:!1,configurable:!0}),u.prototype.install=function(){var e=this;return{getPlatformProducts:function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.validators.iap(),[2,a.apply(void 0,r.__spreadArray([],r.__read(i),!1))]}))}))},createPayment:function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.validators.iap(),[2,c.apply(void 0,r.__spreadArray([],r.__read(i),!1))]}))}))},requestConsentAgreement:function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.validators.iap(),[2,r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,i.call("iap.requestConsentAgreement").catch((function(r){if(r.code&&r.description)throw n.createLiffError(r.code,r.description);throw n.createLiffError(o.UNKNOWN,"Failed to request consent agreement",{cause:r})}))];case 1:return r.sent(),[2]}}))}))]}))}))}}},u}(e.LiffModule);exports.IapModule=u;
